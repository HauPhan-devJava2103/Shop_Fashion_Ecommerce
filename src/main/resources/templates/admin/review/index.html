<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/admin}">
  <head>
    <title>Đánh giá - ADMIN</title>
  </head>
  <body>
    <main layout:fragment="content">
      <div class="d-flex align-items-center justify-content-between mb-3">
        <h4 class="mb-0">Quản lý đánh giá</h4>
      </div>

      <div class="card shadow-sm">
        <div class="table-responsive">
          <table class="table table-striped align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th>ID</th>
                <th>Sản phẩm</th>
                <th>Người dùng</th>
                <th>Rating</th>
                <th>Duyệt</th>
                <th>Ngày tạo</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="r : ${reviews.content}">
                <td th:text="${r.id}"></td>
                <td th:text="${r.product != null ? r.product.productName : '-'}"></td>
                <td th:text="${r.user != null ? r.user.email : '-'}"></td>
                <td th:text="${r.rating}"></td>
                <td>
                  <span class="badge" th:classappend="${r.isApproved} ? ' text-bg-success' : ' text-bg-warning'" th:text="${r.isApproved} ? 'Đã duyệt' : 'Chờ'"></span>
                </td>
                <td th:text="${r.createdAt != null ? #temporals.format(r.createdAt, 'dd/MM/yyyy HH:mm') : '-'}"></td>
              </tr>
              <tr th:if="${reviews.totalElements == 0}">
                <td colspan="6" class="text-center text-muted py-4">Chưa có đánh giá</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <nav class="mt-3" th:if="${totalPages > 1}">
        <ul class="pagination">
          <li class="page-item" th:classappend="${currentPage == 1} ? ' disabled'">
            <a class="page-link" th:href="@{/admin/reviews(page=${currentPage-1}, size=${size})}">Trước</a>
          </li>
          <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPages)}" th:classappend="${i == currentPage} ? ' active'">
            <a class="page-link" th:href="@{/admin/reviews(page=${i}, size=${size})}" th:text="${i}"></a>
          </li>
          <li class="page-item" th:classappend="${currentPage == totalPages} ? ' disabled'">
            <a class="page-link" th:href="@{/admin/reviews(page=${currentPage+1}, size=${size})}">Sau</a>
          </li>
        </ul>
      </nav>
    </main>
  </body>
</html>
